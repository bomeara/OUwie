<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Generalized Hansen model likelihood calculator — OUwie.fixed • OUwie</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Generalized Hansen model likelihood calculator — OUwie.fixed" />
<meta property="og:description" content="Allows the user to calculate the likelihood given a specified set of parameter values" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">OUwie</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">2.9</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/OUwie_2.1_adds.html">New additions as of OUwie 2.1</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/thej022214/OUwie/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Generalized Hansen model likelihood calculator</h1>
    
    <div class="hidden name"><code>OUwie.fixed.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Allows the user to calculate the likelihood given a specified set of parameter values</p>
    </div>

    <pre class="usage"><span class='fu'>OUwie.fixed</span><span class='op'>(</span><span class='va'>phy</span>, <span class='va'>data</span>, model<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"BM1"</span>,<span class='st'>"BMS"</span>,<span class='st'>"OU1"</span>,<span class='st'>"OUM"</span>,<span class='st'>"OUMV"</span>,<span class='st'>"OUMA"</span>,<span class='st'>"OUMVA"</span><span class='op'>)</span>, 
simmap.tree<span class='op'>=</span><span class='cn'>FALSE</span>, root.age<span class='op'>=</span><span class='cn'>NULL</span>, scaleHeight<span class='op'>=</span><span class='cn'>FALSE</span>, root.station<span class='op'>=</span><span class='cn'>FALSE</span>, 
get.root.theta<span class='op'>=</span><span class='cn'>FALSE</span>, shift.point<span class='op'>=</span><span class='fl'>0.5</span>, alpha<span class='op'>=</span><span class='cn'>NULL</span>, sigma.sq<span class='op'>=</span><span class='cn'>NULL</span>, theta<span class='op'>=</span><span class='cn'>NULL</span>, 
clade<span class='op'>=</span><span class='cn'>NULL</span>, mserr<span class='op'>=</span><span class='st'>"none"</span>, check.identify<span class='op'>=</span><span class='cn'>TRUE</span>, algorithm<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"invert"</span>, <span class='st'>"three.point"</span><span class='op'>)</span>, 
tip.paths<span class='op'>=</span><span class='cn'>NULL</span>, quiet<span class='op'>=</span><span class='cn'>FALSE</span><span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>phy</th>
      <td><p>a phylogenetic tree, in <code>ape</code> &#8220;phylo&#8221; format and with internal nodes labeled denoting the ancestral selective regimes</p></td>
    </tr>
    <tr>
      <th>data</th>
      <td><p>a dataframe containing species information (see Details)</p></td>
    </tr>
    <tr>
      <th>model</th>
      <td><p>models to fit to comparative data (see Details).</p></td>
    </tr>
    <tr>
      <th>simmap.tree</th>
      <td><p>a logical indicating whether the input tree is in SIMMAP format. The default is <code>FALSE</code>.</p></td>
    </tr>
    <tr>
      <th>root.age</th>
      <td><p>indicates the age of the tree. This is to be used in cases where the "tips" are not contemporary, such as in cases for fossil trees. Default is <code>NULL</code> meaning latest tip is modern day.</p></td>
    </tr>
    <tr>
      <th>scaleHeight</th>
      <td><p>a logical indicating whether the total tree height should be scaled to 1 (see Details). The default is <code>FALSE</code>.</p></td>
    </tr>
    <tr>
      <th>root.station</th>
      <td><p>a logical indicating whether the starting state, \(\theta_0\), should be estimated.</p></td>
    </tr>
    <tr>
      <th>get.root.theta</th>
      <td><p>a logical indicating whether the starting state, \(\theta_0\), should be estimated (see Details).</p></td>
    </tr>
    <tr>
      <th>shift.point</th>
      <td><p>the point along a branch where a regime change is assumed to have occurred (if <code>SIMMAP=FALSE</code>. The default is set to 0.5, or halfway along a branch.</p></td>
    </tr>
    <tr>
      <th>alpha</th>
      <td><p>a numeric vector giving the values of \(\alpha\) for each selective regime</p></td>
    </tr>
    <tr>
      <th>sigma.sq</th>
      <td><p>a numeric vector giving the values of \(\sigma^2\) for each selective regime</p></td>
    </tr>
    <tr>
      <th>theta</th>
      <td><p>a numeric vector giving the values of \(\theta\) for each selective regime</p></td>
    </tr>
    <tr>
      <th>clade</th>
      <td><p>a list containing a pair of taxa whose MRCA is the clade of interest.</p></td>
    </tr>
    <tr>
      <th>mserr</th>
      <td><p>designates whether a fourth column in the data matrix contains measurement error for each species value ("known"). The measurement error is assumed to be the standard error of the species mean. The default is "none".</p></td>
    </tr>
    <tr>
      <th>check.identify</th>
      <td><p>a logical indicating whether to check that the user-supplied regime paintings will produce identifiable theta estimates. The default is <code>TRUE</code>.</p></td>
    </tr>
    <tr>
      <th>algorithm</th>
      <td><p>designates whether matrix inversion (slow) or the three-point algorithm (fast) of Ho and Ane (2013) should be used.</p></td>
    </tr>
    <tr>
      <th>tip.paths</th>
      <td><p>an optional list that can be provided by the user where each element from 1:nTips is the path from tip to root by labeled node number. The default is NULL and this option is used for internal speedups.</p></td>
    </tr>
    <tr>
      <th>quiet</th>
      <td><p>a logical indicating whether or not to print progress to the screen. The default is "FALSE".</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>The input is a tree and a data file. The tree must be of class &#8220;phylo&#8221; and must contain the ancestral selective regimes as internal node labels. The data file is a data.frame that must have column entries in the following order: [,1] species names and [,2] their current selective regime. The user specifies the  parameter values (i.e. \(\alpha\), \(\sigma^2\), and \(\theta\)).</p>
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p><code>OUwie.fixed</code> returns an object of class <code>OUwie.fixed</code>. This is a list with elements:</p>
<dt>$loglik</dt><dd><p>the maximum log-likelihood.</p></dd>
<dt>$AIC</dt><dd><p>Akaike information criterion.</p></dd>
<dt>$AICc</dt><dd><p>Akaike information criterion corrected for sample-size.</p></dd>
<dt>$BIC</dt><dd><p>Schwartz information criterion.</p></dd>
<dt>$model</dt><dd><p>The model being fit</p></dd>
<dt>$param.count</dt><dd><p>The number of parameters counted in the model.</p></dd>
<dt>$solution</dt><dd><p>a matrix containing the maximum likelihood estimates of \(\alpha\) and \(\sigma^2\).</p></dd>
<dt>$theta</dt><dd><p>a matrix containing the maximum likelihood estimates of \(\theta\).</p></dd>
<dt>$tot.state</dt><dd><p>A vector of names for the different regimes</p></dd>
<dt>$index.mat</dt><dd><p>The indices of the parameters being estimated are returned. The numbers correspond to the row in the <code>eigvect</code> and can useful for identifying the parameters that are causing the objective function to be at a saddlepoint (see Details)</p></dd>
<dt>$simmap.tree</dt><dd><p>A logical indicating whether the input phylogeny is a SIMMAP formatted tree.</p></dd>
<dt>$root.age</dt><dd><p>The user-supplied age at the root of the tree.</p></dd>
<dt>$shift.point</dt><dd><p>The user-specified portion of the branch where a regime shift occurs.</p></dd>
<dt>$data</dt><dd><p>User-supplied dataset</p></dd>
<dt>$phy</dt><dd><p>User-supplied tree</p></dd>
<dt>$root.station</dt><dd><p>A logical indicating whether the starting state, \(\theta_0\), was estimated</p></dd>
<dt>$scaleHeight</dt><dd><p>Indicates whether the tree was constrained to a total height of 1.</p></dd>
<dt>$get.root.theta</dt><dd><p>Indicates whether the root.theta was included in the model.</p></dd>
<dt>$regime.weights</dt><dd><p>A table containing parameter estimates and the weights for time spent in each regime for each tip.</p></dd>
<dt>$algorithm</dt><dd><p>The algorithm used to estimate parameters.</p></dd>

    <h2 class="hasAnchor" id="author"><a class="anchor" href="#author"></a>Author</h2>

    <p>Jeremy M. Beaulieu</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'># \donttest{</span>
<span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span><span class='op'>(</span><span class='va'>tworegime</span><span class='op'>)</span>

<span class='co'>#Calculate the likelihood based on known values of</span>
<span class='co'>#alpha, sigma^2, and theta:</span>
<span class='va'>alpha</span><span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0.5632459</span>,<span class='fl'>0.1726052</span><span class='op'>)</span>
<span class='va'>sigma.sq</span><span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0.1064417</span>,<span class='fl'>0.3461386</span><span class='op'>)</span>
<span class='va'>theta</span><span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1.678196</span>,<span class='fl'>0.4185894</span><span class='op'>)</span>

<span class='fu'>OUwie.fixed</span><span class='op'>(</span><span class='va'>tree</span>,<span class='va'>trait</span>,model<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"OUMVA"</span><span class='op'>)</span>, simmap.tree<span class='op'>=</span><span class='cn'>FALSE</span>, scaleHeight<span class='op'>=</span><span class='cn'>FALSE</span>,
clade<span class='op'>=</span><span class='cn'>NULL</span>, alpha<span class='op'>=</span><span class='va'>alpha</span>,sigma.sq<span class='op'>=</span><span class='va'>sigma.sq</span>,theta<span class='op'>=</span><span class='va'>theta</span>, algorithm<span class='op'>=</span><span class='st'>"three.point"</span><span class='op'>)</span>
</div><div class='output co'>#&gt; <span class='warning'>Warning: The supplied regime painting may be unidentifiable for the regime painting. All regimes form connected subtrees.</span></div><div class='output co'>#&gt; Calculating likelihood using fixed parameter values: 0.5632459 0.1726052 0.1064417 0.3461386 1.678196 0.4185894 </div><div class='output co'>#&gt; 
#&gt; Fit
#&gt;        lnL      AIC     AICc      BIC model ntax
#&gt;  -14.82405 41.64811 43.12179 54.60141 OUMVA   64
#&gt; 
#&gt; 
#&gt; Rates
#&gt;                  1         2
#&gt; alpha    0.5632459 0.1726052
#&gt; sigma.sq 0.1064417 0.3461386
#&gt; 
#&gt; Optima
#&gt;                 1         2
#&gt; estimate 1.678196 0.4185894
#&gt; se             NA        NA
#&gt; </div><div class='input'><span class='co'># }</span>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Jeremy Beaulieu.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


